{"ast":null,"code":"import React,{useState,useEffect,useContext}from\"react\";import{useNavigate}from\"react-router-dom\";import axios from'axios';import UserContext from'../store/UserContext';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function Home(){const navigate=useNavigate();const userCtx=useContext(UserContext);const[modal,setModal]=useState({showModal:false,id:0});const[staffs,setStaffs]=useState();const[loading,setLoading]=useState(false);useEffect(()=>{setLoading(true);const token=localStorage.getItem('token');console.log(token);if(!token){navigate('/login');}else{axios.get('http://127.0.0.1:8080/staff/all',{headers:{Authorization:JSON.parse(token)},timeout:10000}).then(response=>{console.log(response.data);setStaffs(response.data);}).finally(()=>setLoading(false));}},[navigate]);const addClicked=()=>{navigate(\"/add\");};const deleteClicked=id=>{const updatedStaffs=staffs.filter(staff=>staff.id!==id);const token=localStorage.getItem('token');axios.delete(\"http://127.0.0.1:8080/staff/\".concat(id),{headers:{Authorization:JSON.parse(token)}}).then(response=>navigate('/')).catch(err=>console.error(err));setStaffs(updatedStaffs);setModal({showModal:false,id:0});};const editClicked=id=>{const token=localStorage.getItem('token');axios.get(\"http://127.0.0.1:8080/staff/\".concat(id),{headers:{Authorization:JSON.parse(token)}}).then(response=>{navigate(\"/update\",{state:{currStaff:response.data}});console.log(response.data);}).catch(error=>console.log(error));};return/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:!staffs?/*#__PURE__*/_jsx(\"p\",{children:\"loading...\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{className:\"addBtn\",onClick:addClicked,children:\"Add\"}),/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Salary\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Birth Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Address\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Gender\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Phone Number\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Type\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]}),staffs.map(staff=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsxs(\"td\",{children:[staff.fname,\" \",staff.lname]}),/*#__PURE__*/_jsxs(\"td\",{children:[staff.email,\" \"]}),/*#__PURE__*/_jsx(\"td\",{children:staff.salary}),/*#__PURE__*/_jsx(\"td\",{children:staff.birth_date}),/*#__PURE__*/_jsx(\"td\",{children:staff.address}),/*#__PURE__*/_jsx(\"td\",{children:staff.gender}),/*#__PURE__*/_jsx(\"td\",{children:staff.phone_number}),/*#__PURE__*/_jsx(\"td\",{children:staff.staffType}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"button\",{className:\"deleteBtn\",onClick:()=>setModal({showModal:true,id:staff.id}),children:\"Delete\"}),/*#__PURE__*/_jsx(\"button\",{className:\"updateBtn\",onClick:()=>editClicked(staff.id),children:\"Edit\"})]})]}))]}),/*#__PURE__*/_jsx(\"div\",{className:modal.showModal?\"backdrop\":\"backdropNone\",children:/*#__PURE__*/_jsxs(\"div\",{className:modal.showModal?\"modal\":\"modalNone\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Are you sure you want to delete this staff?\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteClicked(modal.id),children:\"Yes\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setModal({showModal:false,id:0}),children:\"No\"})]})]})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/addDeleteUser'),children:\"Add or delete a user\"})]})});}export default Home;","map":{"version":3,"names":["React","useState","useEffect","useContext","useNavigate","axios","UserContext","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Home","navigate","userCtx","modal","setModal","showModal","id","staffs","setStaffs","loading","setLoading","token","localStorage","getItem","console","log","get","headers","Authorization","JSON","parse","timeout","then","response","data","finally","addClicked","deleteClicked","updatedStaffs","filter","staff","delete","concat","catch","err","error","editClicked","state","currStaff","className","children","onClick","map","fname","lname","email","salary","birth_date","address","gender","phone_number","staffType"],"sources":["F:/Uni/Term 6/Database/dblab_project/dblab_final/frontend/staffs/src/components/home.jsx"],"sourcesContent":["import React, { useState,useEffect,useContext } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport axios from 'axios';\r\nimport UserContext from '../store/UserContext'\r\n\r\nfunction Home() {\r\n  const navigate = useNavigate();\r\n  const userCtx = useContext(UserContext)\r\n  const [modal, setModal] = useState({ showModal: false, id: 0 });\r\n  const [staffs, setStaffs] = useState();\r\n  const [loading,setLoading] = useState(false);\r\n\r\n\r\n  useEffect(()=>{\r\n    setLoading(true);\r\n    const token = localStorage.getItem('token');\r\n    console.log(token);\r\n    if(!token){\r\n        navigate('/login')\r\n    }else{\r\n        axios.get('http://127.0.0.1:8080/staff/all',{\r\n        headers: {\r\n            Authorization:  JSON.parse(token),\r\n        },\r\n            timeout: 10000,\r\n        }).then(response=>{\r\n\r\n            console.log(response.data)\r\n        setStaffs(response.data)\r\n        }).finally(()=> setLoading(false));\r\n    }\r\n  },[navigate])\r\n\r\n  const addClicked = () => {\r\n    navigate(\"/add\");\r\n  };\r\n\r\n  const deleteClicked = (id) => {\r\n    const updatedStaffs = staffs.filter((staff) => staff.id !== id);\r\n        const token = localStorage.getItem('token');\r\n        axios.delete(`http://127.0.0.1:8080/staff/${id}`,{\r\n        headers: {\r\n            Authorization: JSON.parse(token)\r\n        }}).then(response => navigate('/')).catch(err =>console.error(err))\r\n    setStaffs(updatedStaffs);\r\n    setModal({ showModal: false, id: 0 });\r\n  };\r\n\r\n  const editClicked = (id) => {\r\n\r\n   const token = localStorage.getItem('token')\r\n      axios.get(`http://127.0.0.1:8080/staff/${id}`,{\r\n          headers : {\r\n              Authorization: JSON.parse(token)\r\n          }\r\n      }).then(response =>  {navigate(`/update`,{state: {currStaff: response.data}})\r\n        console.log(response.data)\r\n      }).catch(error => console.log(error));\r\n\r\n\r\n  };\r\n\r\n\r\n\r\n  return (\r\n    <div className=\"container\">\r\n    {!staffs ? <p>loading...</p> :   <>\r\n     <button className=\"addBtn\" onClick={addClicked}>\r\n                                              Add\r\n                                            </button>\r\n                                            <table>\r\n                                              <tr>\r\n                                                <th>Name</th>\r\n                                                <th>Email</th>\r\n                                                <th>Salary</th>\r\n                                                <th>Birth Date</th>\r\n                                                <th>Address</th>\r\n                                                <th>Gender</th>\r\n                                                <th>Phone Number</th>\r\n                                                <th>Type</th>\r\n                                                <th>Actions</th>\r\n                                              </tr>\r\n                                              {staffs.map((staff) => (\r\n                                                <tr>\r\n                                                  <td>{staff.fname} {staff.lname}</td>\r\n                                                  <td>{staff.email} </td>\r\n                                                  <td>{staff.salary}</td>\r\n                                                  <td>{staff.birth_date}</td>\r\n                                                  <td>{staff.address}</td>\r\n                                                  <td>{staff.gender}</td>\r\n                                                  <td>{staff.phone_number}</td>\r\n                                                  <td>{staff.staffType}</td>\r\n                                                  <td>\r\n                                                    <button\r\n                                                      className=\"deleteBtn\"\r\n                                                      onClick={() => setModal({ showModal: true, id: staff.id })}\r\n                                                    >\r\n                                                      Delete\r\n                                                    </button>\r\n                                                    <button\r\n                                                      className=\"updateBtn\"\r\n                                                      onClick={() => editClicked(staff.id)}\r\n                                                    >\r\n                                                      Edit\r\n                                                    </button>\r\n                                                  </td>\r\n                                                </tr>\r\n                                              ))}\r\n                                            </table>\r\n                                            <div className={modal.showModal ? \"backdrop\" : \"backdropNone\"}>\r\n                                              <div className={modal.showModal ? \"modal\" : \"modalNone\"}>\r\n                                                <p>Are you sure you want to delete this staff?</p>\r\n                                                <div>\r\n                                                  <button onClick={() => deleteClicked(modal.id)}>Yes</button>\r\n                                                  <button onClick={() => setModal({ showModal: false, id: 0 })}>\r\n                                                    No\r\n                                                  </button>\r\n                                                </div>\r\n                                              </div>\r\n                                            </div>\r\n                                              <button onClick={()=> navigate('/addDeleteUser')}>Add or delete a user</button>\r\n                                            </>}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Home;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}